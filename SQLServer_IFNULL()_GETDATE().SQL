/* ENDERECO */

INSERT INTO ENDERECO VALUES('FLAMENGO','RJ',1)
INSERT INTO ENDERECO VALUES('MORUMBI','SP',2)
INSERT INTO ENDERECO VALUES('CENTRO','MG',4)
INSERT INTO ENDERECO VALUES('CENTRO','SP',6)
GO

/* CRIANDO A TABELA TELEFONES */
CREATE TABLE TELEFONE(
    IDTELEFONE INT PRIMARY KEY IDENTITY,
    TIPO CHAR(3) NOT NULL,
    NUMERO VARCHAR(10) NOT NULL,
    ID_ALUNO INT,
    CHECK (TIPO IN ('RES','COM','CEL'))
)
GO

INSERT INTO TELEFONE VALUES('CEL','7899889',1)
INSERT INTO TELEFONE VALUES('RES','4325444',1)
INSERT INTO TELEFONE VALUES('COM','4354354',2)
INSERT INTO TELEFONE VALUES('CEL','2344556',2)
GO

/* PEGAR DATA ATUAL */
SELECT GAETDATE()
GO

/* CLAUSULA AMBIGUA */
SELECT
    A.NOME,
    ISNULL(T.TIPO, 'SEM NUMERO') AS "TIPO",
    ISNULL(T.NUMERO,'SEM NUMERO') AS "TELEFONE",
    E.BAIRRO,
    E.UF
FROM
    ALUNO A
LEFT JOIN TELEFONE T
ON A.IDALUNO = T.ID_ALUNO
INNER JOIN ENDERECO E
ON A.IDALUNO = E.ID_ALUNO
GO 
/*
ANDRE	CEL	7899889	    	FLAMENGO	    RJ
ANDRE	RES	4325444	    	FLAMENGO	    RJ
ANA     COM	4354354	    	MORUMBI	    	SP
ANA	    CEL	2344556		    MORUMBI	    	SP
JOAO	SEM	SEM NUMERO	    CENTRO	    	MG
*/